import{r as t,h as i,g as e}from"./p-8af21e1f.js";var n,s,c,o;function r(t){const{limetype:i,id:e}=this.context;if(t[i])return t[i].find(t=>t.id===e)}function u(t){return t.session}function l(t,i){return(e,n)=>{const s=function(t,i,e,n){let s=a.find(i=>i.component===t);return s||(s={properties:[],component:t},a.push(s)),s.properties.push({options:e,name:i,service:{name:n.name,method:n.method||"subscribe"}}),s}(e,n,t,i);1===s.properties.length&&function(t,i){const e=t.componentWillLoad,n=t.componentDidUnload,s=[];t.componentWillLoad=function(...t){if(i.forEach(t=>{h.apply(this,[s,t])}),e)return e.apply(this,t)},t.componentDidUnload=function(...t){n&&n.apply(this,t),f.apply(this,[s])}}(e,s.properties)}}!function(t){t.Translate="translate",t.Http="http",t.Route="route",t.Notification="notifications",t.Query="query",t.CommandBus="commandBus",t.Dialog="dialog",t.EventDispatcher="eventDispatcher",t.LimetypesState="state.limetypes",t.LimeobjectsState="state.limeobjects",t.ApplicationState="state.application",t.ConfigsState="state.configs",t.FiltersState="state.filters",t.DeviceState="state.device",t.TaskState="state.tasks"}(n||(n={})),function(t){t.AND="AND",t.OR="OR",t.EQUALS="=",t.NOT="!",t.GREATER=">",t.LESS="<",t.IN="IN",t.BEGINS="=?",t.LIKE="?",t.LESS_OR_EQUAL="<=",t.GREATER_OR_EQUAL=">="}(s||(s={})),function(t){t.Received="command.received",t.Handled="command.handled",t.Failed="command.failed"}(c||(c={})),function(t){t.Pending="PENDING",t.Started="STARTED",t.Retry="RETRY",t.Success="SUCCESS",t.Failure="FAILURE"}(o||(o={}));const a=[];function h(t,i){let e=t.find(t=>t.instance===this);e||(e={instance:this,unsubscribes:[]},t.push(e));const n=m.apply(this,[i.options,i.name,i.service.name,i.service.method]);e.unsubscribes.push(n)}function f(t=[]){t.find(t=>t.instance===this).unsubscribes.forEach(t=>t());for(let i=t.length-1;i>=0;i--)t[i].instance===this&&t.splice(i,1)}function m(t,i,e,n){const s=Object.assign({},t);!function(t,i){t.filter&&(t.filter=t.filter.map(t=>t.bind(i))),t.map&&(t.map=t.map.map(t=>t.bind(i)))}(s,this);const c=this.platform;if(!c.has(e))throw new Error(`Service ${e} does not exist`);return c.get(e)[n](function(t,i){return e=>{t[i]=e}}(this,i),s)}var d=function(t,i,e,n){var s,c=arguments.length,o=c<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,e,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(o=(c<3?s(o):c>3?s(i,e,o):s(i,e))||o);return c>3&&o&&Object.defineProperty(i,e,o),o};const p=class{constructor(i){t(this,i),this.document={},this.session={},this.config={},this.includePerson=!0,this.includeCoworker=!0,this.cloneDocument=!0,this.allowedExtensions=Object.freeze(["PDF","DOC","DOCX"]),this.setCloneDocument=t=>{t.stopPropagation(),this.cloneDocument=t.detail}}goToScrive(t){window.open(`${this.config.limepkg_scrive.scriveHost}/public/?limeDocId=${t}&lang=${this.session.language}&usePerson=${this.includePerson}&useCoworker=${this.includeCoworker}&clone=${this.cloneDocument}`)}files(){var t;const i=(null===(t=this.document)||void 0===t?void 0:t._files)||{};return Object.keys(i).map(t=>i[t])}isSignable(t){return this.allowedExtensions.includes((t.extension||"").toUpperCase())}render(){if("document"!==this.context.limetype)return;const t=this.files().filter(this.isSignable,this);if(0===t.length||t.length>1)return;const e=this.platform.get(n.Translate),s=e.get("limepkg_scrive.primary_action"),c=e.get("limepkg_scrive.clone_document"),o=e.get("limepkg_scrive.clone_warning");return i("section",null,i("limel-config",{config:{iconPath:"/static/limepkg_scrive/static/"}}),i("limel-button",{label:s,outlined:!0,icon:"scrive",onClick:()=>this.goToScrive(this.context.id)}),i("limel-checkbox",{label:c,checked:this.cloneDocument,onChange:this.setCloneDocument}),i("p",null,o))}get element(){return e(this)}static get style(){return".container{margin-left:1.25rem;margin-right:1.25rem}"}};var v;d([function(t={}){const i={name:n.LimeobjectsState};return t.map=[r,...t.map||[]],l(t,i)}()],p.prototype,"document",void 0),d([function(t={}){const i={name:n.ApplicationState};return t.map=[u,...t.map||[]],l(t,i)}()],p.prototype,"session",void 0),d([(v={},l(v,{name:n.ConfigsState}))],p.prototype,"config",void 0);export{p as lwc_limepkg_scrive};